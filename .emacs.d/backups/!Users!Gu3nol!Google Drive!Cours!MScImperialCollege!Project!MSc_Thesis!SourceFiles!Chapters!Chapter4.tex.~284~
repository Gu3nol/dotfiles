\chapter{Bioinspired pH-sensor}
\renewcommand{\baselinestretch}{\mystretch}
\label{chap:VBioinspiredpHSensor}
% \setlength{\parindent}{0pt}

\section{Presentation of the pH-sensing system}
\PARstart{T}{his} thesis is based on two parts. On the one hand, the idea is to use a novel geometry and study its potential benefit for 0.18 $\mu m$ and 0.35 $\mu m$ CMOS processes. Then it must implement a pixel for a DNA microarray in AMS 0.35 $\mu m$ standard CMOS technology without alteration of the process. On the other hand, a peripheral system is created to test the new array and characterise the hexagonal ISFET and an experimental lab-on-chip device.

In this section, the hexagonal architecture and the pixel implementation are described. Various metrics and analysis have been tested and detailed. It starts from the modelization of an new hexagonal transistors to a pixel architecture and the evaluation of its performances. All this work has been done using the Cadence Virtuoso Software Suite.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Modelling of the 0.35 $\mu m$ hexagonal ISFET}
For the purpose of a future implementation in standard CMOS AMS 0.35 $\mu m$, the layout design of the hexagonal transistor have to respect some design rules.  These limitation, concerning DRC and LVS recognition are detailed and lead to a proposed architecture which is given. Then, the transistor parameters and the model of this new structure is established according to the standard hexagonal MOSFET.

\subsection{AMS 0.35 $\mu m$ design rules - The transistor structure}
First of all, in Table~\ref{Tab:NMOS_layer} are defined all the necessary layers required to design a NMOS transistor
\begin{table}[h]
  \centering
  \begin{threeparttable}

    \begin{tabular}{@{} c | *3c @{}}
      \toprule
      \multicolumn{1}{c }{Layers} & Description & Color indication \\
      \midrule
      DIFF & Diffusion layer  & Light green \\
      NPLUS & $n+$ implant layer & Creme\\
      PPLUS & $p+$ implant layer & Yellow \\
      POLY1 & Polysilicon 1 layer & Red \\
      CONT & Contact (connect METAL1 to DIFF, POLY1) & Dark green \\
      METAL1 & Metal 1 layer & Blue \\
      \bottomrule
    \end{tabular}
  \end{threeparttable}
  \caption{\footnotesize Layers required for a NMOS transistor}
  \label{Tab:NMOS_layer}
\end{table}

With these layer and according to the design process rules of the technology, it is possible to define a clear and simple set of the rules which have an impact on the design of an hexagonal EGT. The most important rules that have piloted the final architecture are therefore presented in Table~\ref{Tab:design_rules}.
\begin{table}[h]
  \centering
  \begin{threeparttable}
    \begin{tabular}{@{} c | *2c @{}}
      \toprule
      \multicolumn{1}{c }{Rules} & Information \\
      \midrule
      Corners & Authorized angles: 90$\degree$, 135$\degree$  \\
      Minimum POLY1 to DIFF spacing & 0.2 $\mu m$ \\
      Minimum POLY1 extension of gate & 0.5 $\mu m$ \\
      Minimum gate length of NMOS & Smallest feature: 0.35 $\mu m$  \\
      Minimum METX enclosure of CONT & Spacing between source, gate and drain \\
      Orientation of CONT and VIAS & Anthorized angles: 0$\degree$, 90$\degree$ \\
      \bottomrule
    \end{tabular}
  \end{threeparttable}
  \caption{\footnotesize Significant design rules}
  \label{Tab:design_rules}
\end{table}

As the purpose of this thesis is to respect the aforementioned rules, it lead to some consideration about the possible design. Indeed, the creation of a regular hexagon with 60\degree angles is no more possible. Due to the Manhattan architecture the angles allowed are limited to 0\degree, 45\degree and 90\degree. Then, it also involves that the size of the side of the hexagon will not be equal. Moreover as a result of the on-grid constraint the length of the transistor will not be the same on all sides.

Finally, all the others design rules concerning spacing between layers and enclosure sizes will determine the minimum size of the overall structure. The most constraining thing are intimately related to the spacing between the gate and source/drain contacts. The fact that contact and vias can not be rotated is also a particular consideration in term of final area.

\subsection{Proposed architecture}
According to the previous study, it is possible to draw various structure in accordance with the principles defined. However, all structures are not feasible and acceptable and many of them have been discarded. The Fig.~\ref{Fig:Hex_dis} presents some of non admissible layouts which could lead to potential confusions.
\begin{figure}[h]
  \centering
  \subfigure[]{\label{Fig:HEX_a}\includegraphics[width=0.26\textwidth]{Figs/Chap3/HEX_a_0_35.png}}
  \subfigure[]{\label{Fig:HEX_b}\includegraphics[width=0.27\textwidth]{Figs/Chap3/HEX_b_0_35.png}}
  \subfigure[]{\label{Fig:HEX_c}\includegraphics[width=0.24\textwidth]{Figs/Chap3/HEX_c_0_35.png}}
  \caption{\footnotesize Discarded structures for hexagonal transistors}
  \label{Fig:HEX_dis}
\end{figure}


\paragraph{(a)} On the first schematic~\ref{Fig:HEX_a} a full enclosed gate structure has been experienced. The gate contact is placed on the side because it cannot be placed on the diffusion layer. However, when the LVS is executed on this layout the following error appear; ``Waffle trans gate : these gate cannot be identified correctly due to angle/size of poly hole and are discarded from LVS.'' It involves that EGTs would not be implemented in the chosen process because this one does not allow waffle, \textit{i.e.} closed-structure. A completely enclosed gate will form an unauthorized hole in a polysilicon surface. This organization has been abandoned.
\paragraph{(b)} From the previous attempt, others approaches has been tested. Fig.\ref{Fig:HEX_a} includes two ideas which have been tested separately then combined. In the interest of clarity the combined solution is presented. On the one hand, from the layout ~\ref{Fig:HEX_a}, a part of the gate has been removed on the right side to ``open'' the gate. Nevertheless, the DRC rules does not allow a contact of three different gates over a diffusion layer. In other word, it is impossible to design a cross with poly-gates.

On the other hand, the diffusion layer has been removed under the ``cross'' on the left side. If the gate is left open the same error than in Fig.~\ref{Fig:HEX_a} is also returned by the DRC and if the figure is as in Fig.\ref{Fig:HEX_b}, this time, during the LVS process an inconsistent length of device appears. This solution is not suitable either.
\paragraph{(c)} Finally for Fig.~\ref{Fig:HEX_a}, during the LVS gate recognition operated by the software, this stricture is analyzed as two transistors in parallel. This is no more a single device. This interpretation can simply be explain by the two contact used. This structure should be removed from further analysis even though in this case the design rules are respected.

\paragraph{Solution} In the end, a final hexagonal structure is derived from all the constraints and the specification. It is declared in Fig.~\ref{Fig:HEX_0_35}, which a trade-off between the respect of the rules and the specifications of EGTs. The outter square represents the substrate contact of the device (\textit{i.e.} the bulk). The size used has been minimized to the maximum to reduce the final area.
\begin{figure}[h]
  \centering
  \includegraphics[scale=0.05]{Figs/Chap3/Hex_0_35.png}
  \caption{\footnotesize Layout of the proposed hexagonal transistor in AMS 0.35 $\mu m$ (L = 0.35 $\mu m$)}
  \label{Fig:HEX_0_35}
\end{figure}

This structure is free of any DRC/LVS errors and matched the requirement of the technology chosen. However, no adaptations have the technology have been made in order to realize the transistor and so we notice that we are not in the strict case of enclosed-gate transistors. Indeed, the even though the gate is encircle an inner contact, the diffusion layer is not continuous because of the LVS rules about waffle structures.

Nonetheless for the benefit of this work and in the interest of simplification, an assumption of perfect EGT is made. The gate is considered unbroken over the diffusion layer.

\subsection{Extention to the AMS 0.18 $\mu m$ technology}
This work involve to estimate the projection of hexgonal ISFETs for deeper sub-micron technology. With this aim, the same analysis has been made for the standard AMS CMOS 0.18 $\mu m$ process. Most of the rules followed previously are still valid and determine the final architecture which is given in Fig.\ref{Fig:HEX_0_18}.
\begin{figure}[h]
  \centering
  \includegraphics[scale=0.05]{Figs/Chap3/Hex_0_18.png}
  \caption{\footnotesize Layout of the proposed hexagonal transistor in AMS 0.18 $\mu m$ (L = 0.23 $\mu m$)}
  \label{Fig:HEX_0_18}
\end{figure}

This time, the structure does not pass the DRC. In fact, the new design rules are not allowing 90$\degree$ over the diffusion layer. It is obviously the case on the top and bottom of the transistor. In this case, hexagonal structures are not possible at all. However, to support the idea of this work, result in 0.18$\mu m$ are also given and bring a complementary information.

The indicated layout in this process has not been realized and will not be tested.

\subsection{The transistor parameters}
\label{trans_param}
In order to use the transistor designed in an effective circuit, the effective $W/L_{eff}$ of the device has to be determined. For this purpose, a model of the proposed architecture is presented in Fig.~\ref{Fig:Hex_sch}. As it has been mentionned before, this is a non-regular hexagonal layout due to the design constraints. As a consequence, the 45$\degree$ angle is found to describe the structure. Furthermore, due to the perfect EGT assumption, the contact on the gate is considered negligible and the channel of the transistor would appear all around the gate.  This is why the gate polysilicon (in grey on the model) enclosed all the drain area.

Other parameters such as $L_1$ and $L_2$, respectively the inner and outer length, as well as $H_1$ the inner height and $H_2$ the outer height help to describe the figure.
\begin{figure}[h]
  \centering
  \includegraphics[scale=0.8]{Figs/Chap3/Hex_non_reg}
  \caption{\footnotesize Hexagonal transistor model for the evaluation of the effective width and length}
  \label{Fig:Hex_sch}
\end{figure}

It should be mentioned that due to grid contrainst alignment the apparent length $l_2$ is a function of the length $l_1$;
\begin{equation}
  l_2 = \sqrt{2}\ l_1
\end{equation}

In our case, the ratio $W/L_{eff}$ is approximated by integrating the I/V relationship over the total gate length of the transistor for an infinitesinal distance $dx$. The calculation is done when the voltage drop along the channel is linear;
\begin{eqnarray}
  v_{gs} - v_{TH} = v_{ds}
\end{eqnarray}
It corresponds to the transition point between the linear and the saturation region of the transistor. This methods is adapted from \citep{RefWorks:51, RefWorks:153} where it has been verified. However, for our particular structure, we need to consider the six sides of the transistor separately.
\paragraph{For the sides 1 and 4}
With respect to the source $(\forall x \in [L_1,L_2])$, the incremental voltage drop along the channel is given by;
\begin{eqnarray}
  v_{cs}(x) = \frac{v_{ds}(x-L_2)}{L_1-L_2}
  \implies dv_{cs}(x) = \frac{v_{ds}}{L_1-L_2}dx
\end{eqnarray}

Moreover, the mobile channel charge determines the incremental resistance;
\begin{eqnarray}
  dR_{ds}(x) = \frac{1}{\mu C_{ox}(v_{gs}-V_{TH}-v_{cs}(x))}\ \left( \frac{dx}{x} \right )
\end{eqnarray}

Then thanks to the Ohm's law, the current through the channel is proportional to the voltage drop $dv_{cs}(x)$ across the incremental resistance $dR_{cs}(x)$;
\begin{alignat}{2}
  &&i_{ds}
  &= \frac{dv_{cs}(x)}{dR_{ds}(x)} \notag\\
  &\Rightarrow\quad
  &i_{ds}(x)\left (\frac{dx}{x} \right)
  &= \frac{v_{ds}}{L_1-L_2} \ \mu C_{ox} (v_{ds}-v_{cs}(x))\notag\\
  &\Rightarrow\quad
  &&= \frac{v_{ds}^2}{(L_1-L_2)^2} \ \mu C_{ox} (L_{1}-x)
\end{alignat}

By integrating over the total length $l_1$ of the transistor;
\begin{alignat}{2}
  &&\int_{L_1}^{L_2} \frac{i_{ds}}{x} \, \mathrm{d}x
  &= \int_{L_1}^{L_2} \frac{v_{ds}^2}{(L_1-L_2)^2} \ \mu C_{ox} (L_{1}-x)  \, \mathrm{d}x \notag\\
  &\Rightarrow\quad
  &i_{ds}
  &= \frac{1}{ln\left[\frac{L_2}{L_2} \right ]}        \frac{\mu C_{ox}}{2}\  v_{ds}^2\notag\\
  &\Rightarrow\quad
  &&= \frac{1}{ln\left[\frac{L_2}{L_1} \right ]}        \frac{\mu C_{ox}}{2}\  (v_{gs} - v_{TH})^2
\end{alignat}


\paragraph{For the others sides, 2,3 and 5,6}
This time the incremental voltage drop along the channel is given by;
\begin{eqnarray}
  v_{cs}(x) = \frac{v_{ds}(x-H_2cos(45\degree))}{(H_1-H_2)cos(45\degree)}
  \implies dv_{cs}(x) = \frac{v_{ds}}{(H_1-H_2)cos(45\degree)}dx
\end{eqnarray}

Using the same derivation but this time integrating over the total length $l_2$ of the transistor, we obtain;
\begin{alignat}{2}
  &&\int_{H_1cos(45\degree)}^{H_2cos(45\degree)} \frac{i_{ds}}{x} \, \mathrm{d}x
  &= \int_{H_1cos(45\degree)}^{H_2cos(45\degree)} \frac{ \mu C_{ox}v_{ds}^2}{(H_1-H_2)^2cos(45\degree)} \ (H_{1}-\frac{x}{cos(45\degree)}) \, \mathrm{d}x \notag\\
  &\Rightarrow\quad
  &i_{ds}
  &= \frac{1}{ln\left[\frac{H_2}{H_1} \right ]cos(45\degree)}        \frac{\mu C_{ox}}{2}\  (v_{gs} - v_{TH})^2
\end{alignat}

\paragraph{Finally,} when the six sides of the hexagon are taken into account, the current-voltage characteristic is;
\begin{eqnarray}
  6i_{ds} = \left[ \left. 2 \middle / \left( ln \left [\frac{L_2}{L_1} \right ]\right ) \right. + \left. 4 \middle / \left( ln \left [\frac{H_2}{H_1} \right ] cos(45\degree) \right ) \right. \right].     \frac{\mu C_{ox}}{2}\  (v_{gs} - v_{TH})^2 \notag\\
\end{eqnarray}
Then,
\begin{equation}
  \left [ \frac{W}{L} \right ] _{eff} = \left. 2 \middle / \left( ln \left [\frac{L_2}{L_1} \right ]\right ) \right. + \left. 4 \middle / \left( ln \left [\frac{H_2}{H_1} \right ] cos(45\degree) \right ) \right.
  \label{WL_HEX_eff}
\end{equation}

The Eq. \ref{WL_HEX_eff} defines a relationship between the simple geometrical parameters $L_1, L_2, H_1, H_2$ of the gate to the effective $W/L_{eff}$ ratio. For instance, in 0.35 $\mu m$, by considering the ground rules of the technology used, for an hexagonal transistor with a minimum gate length of 0.35 $\mu m$, the effective gate width is equal to 10.41 $\mu m$.

\textit{N.B.:} The EGT assumption will of course affect this formula in our case.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Hexagonal ISFET analysis}
Extraction of various metrics to characterise the new transistor.
Insist on the fundamentals / the science of the system


\subsection{Transistor geometry W/L}
Comparison between proposed-model and simulation data (using foundry provided tool).

\subsection{Channel-Gate capacitance}

\subsection{Gain Gm}



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Pixel architecture}
Presentation of the pixel architecture, chosen as simple as possible and using only two transistors (HEX + switch)

\subsection{Pixel scheme}
\subsection{Readout circuit}
\subsection{Operation}
\subsection{Attenuation}
\subsection{Input referred noise}
\subsection{Matching performances / Monte-Carlo analysis}
\subsection{Results}
Conclusion on the results obtained and the possibility to use this new pixel. Even though the results are small, an experimental verification/testing need to be done to validate the simulations

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\section{Pixel pH sensitivity}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Results and discussion}










%%% Local Variables:
%%% mode: latex
%%% TeX-master: "../MScThesis"
%%% End:
